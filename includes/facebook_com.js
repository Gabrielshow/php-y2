!function(e){function t(t){for(var o,i,s=t[0],l=t[1],d=t[2],u=0,f=[];u<s.length;u++)i=s[u],r[i]&&f.push(r[i][0]),r[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(c&&c(t);f.length;)f.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={2:0},a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var c=l;a.push([226,0]),n()}({123:function(e,t,n){var o=n(47),r=n(220);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a,i=0,s={injectType:"lazyStyleTag",insert:"head",singleton:!1},l={};r.locals&&(l.locals=r.locals),l.use=function(){return i++||(a=o(r,s)),l},l.unuse=function(){i>0&&!--i&&(a(),a=null)},e.exports=l},220:function(e,t,n){(t=n(48)(!1)).push([e.i,"._2IC6m--container{display:flex;font-family:inherit;margin-right:10px;font-weight:600;color:#65676b;line-height:1.6;border-radius:4px;padding:5px 4px;cursor:pointer}._2IC6m--container:hover{background-color:rgba(0,0,0,.05)}._1TZ3M--text{margin-left:4px}._3tDCD--circle-container{padding:0;border-radius:100%;width:40px;height:40px;background:#e4e6eb}._3tDCD--circle-container:hover{background-color:#fff}._3tDCD--circle-container ._2-I4O--logo{margin:0 auto;max-width:20px}",""]),t.locals={container:"_2IC6m--container",text:"_1TZ3M--text","circle-container":"_3tDCD--circle-container",circleContainer:"_3tDCD--circle-container",logo:"_2-I4O--logo"},e.exports=t},226:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(15),a=n(17),i=n(20),s=n(21),l=n(13),d=n(7),c=n(14),u=n(11),f=n(2),p=n(1),h=n(12),m=n(5),v=n(10),g=n(18),b=n(9),y=n(38),k=n(3),w=n(123),x=n.n(w),S=n(32),M=n(28),B=n.n(M);const F=Object(r.a)().svg.getSrc("download","#84bd07");var C=k.c.memo(({classes:e=[],isIcon:t=!0,isText:n=!0,isCircle:r=!1,onClick:a})=>{const i=Object(S.a)(x.a);return(k.c.createElement("div",{className:B()(...e,i.container,r&&i.circleContainer),onClick:a},t&&k.c.createElement("img",{src:F,className:i.logo}),n&&k.c.createElement("span",{className:i.text},o.a.i18n.getMessage("download"))))}),L=n(4);const _=n(49),E=Object(v.a)("facebook_com");g.a.isSingle()&&Object(a.b)("facebook",(function(e,t){const n=Object(r.a)(t);var a=t.preferences,v=a.moduleFacebook?1:0;o.a.onMessage.addListener((function(t,n,o){if("getModuleInfo"===t.action){if(t.url!==location.href)return;return o({state:v,moduleName:e})}if("changeState"===t.action){if(e!==t.moduleName)return;return g.changeState(t.state)}"updatePreferences"!==t.action?v&&"updateLinks"===t.action&&(g.changeState(0),g.changeState(1)):Object.assign(a,t.preferences)})),v&&setTimeout((function(){g.run()}));var g={contextMenu:null,className:"savefrom_fb_download",isMutation:!1,run:function(){if(v=1,M.addStyle(),S.injectStyle(),b.a.isAvailable())return this.isMutation=!0,this.initEmbedDownloader(),void this.mutationMode.enable()},changeState:function(e){g.hideMenu(),v=e,k.disable(),S.rmCurrentPhotoBtn(),S.rmDataAttrs(),M.rmBtn(),x.rmBtn(),g.mutationMode.stop(),e&&g.run()},initEmbedDownloader:function(){n.addStyleRules("."+n.embedDownloader.linkClass+" img",{opacity:".5"}),n.embedDownloader.init()},mutationMode:{observer:null,stop:function(){this.observer&&this.observer.stop(),["sfSkip"].forEach((function(e){for(var t,n=Object(l.a)(e),o=document.querySelectorAll("["+n+"]"),r=0;t=o[r];r++)t.removeAttribute(n)}))},wrapVideoGetLinks:function(e){switch(e.tagName){case"EMBED":x.getLinksFromEmbed(e,(function(e){x.appendLinks(e&&e.links)}));break;case"VIDEO":x.getLinksFromVideo(e,(function(e){x.appendLinks(e&&e.links)}))}},wrapVideoFeedOnLinkHover:function(){v&&M.onLinkHover.apply(this)},wrapPhotoOnHover:function(e){v&&S.addCurrentDlBtn(this)},wrapExternalMediaMouseEnter:function(){if(v){this.dataset[k.linkDataAttr]?clearTimeout(k.timer):k.handle(this)?(k.lastLink&&k.lastLink!==this&&k.removeBtn(k.lastLink),n.embedDownloader.hidePanel(),k.lastLink=this):(f.a.off(this,"mouseenter",g.mutationMode.wrapExternalMediaMouseEnter),f.a.off(this,"mouseleave",g.mutationMode.wrapExternalMediaMouseLeave))}},wrapExternalMediaMouseLeave:function(){if(v){var e=this;e.dataset[k.linkDataAttr]&&(clearTimeout(k.timer),k.timer=setTimeout((function(){k.removeBtn(e)}),1500))}},wrapExternalMedia:function(e){f.a.on(e,"mouseenter",g.mutationMode.wrapExternalMediaMouseEnter),f.a.on(e,"mouseleave",g.mutationMode.wrapExternalMediaMouseLeave)},enable:function(){if(this.observer)return this.observer.start();const e=(e,t)=>{if(!e.dataset.sfReady)return e.dataset.sfReady="1",t(e)};this.observer=new b.a({queries:[...(()=>[{css:"video",is:"added",callback:({added:t})=>{const n=/\/watch/.test(location.href);t.forEach(t=>e(t,()=>{if(n)return M.addButtonForWatchPage(t);return t.closest('[role="article"]')?M.addButtonForFeedPage(t):void 0}))}},{css:'[role="article"] a[href*="/videos/"], ._6x84 a[href*="/videos/"]',is:"added",callback:({added:t})=>{t.forEach(t=>e(t,()=>{M.addHoverButtonForArticleVideo(t)}))}},{css:'[role="article"] a[role="link"] div[style] img[alt], [role="article"] div[role="button"] div[style] img[alt]',is:"added",callback:({added:t})=>{t.forEach(t=>e(t,()=>{S.addButtonForArticleImage(t)}))}},{css:'[data-pagelet="TahoeVideo"]',is:"added",callback:({added:t})=>{t.forEach(t=>e(t,()=>{M.addButtonForShowPageVideo(t)}))}},{css:'[data-pagelet="TahoeRightRail"] a[href*="/videos/"]',is:"added",callback:({added:t})=>{t.forEach(t=>e(t,()=>{const e=w.createButton(()=>{const n=x.getVideoIdFromLink(t.href);n&&x.showDownloadMenuByVideoId(e,n)},{preset:"hover"});t.appendChild(e)}))}},{css:'[data-pagelet="MediaViewerPhoto"]',is:"added",callback:({added:t})=>{t.forEach(t=>e(t,()=>{S.addButtonForShowPageImage(t)}))}}])(),{css:["embed","video._ox1"],is:"added",callback:e=>{for(let n,o=0;n=e.added[o];o++){var t=!1;Object(c.a)(n,`#fbxPhotoContentContainer .videoStage ${n.tagName}`)&&(t=!0),t?this.wrapVideoGetLinks(n):f.a.one(n,"mouseenter",this.wrapVideoFeedOnLinkHover)}}},{css:[".fbPhotoSnowliftContainer .stageWrapper .stage img.spotlight",".fbPhotoSnowliftContainer .stageWrapper .stage .videoStage video"],is:"added",callback:e=>{for(let o,r=0;o=e.added[r];r++)if(g.hideMenu(),!(o.dataset.sfSkip>0)){o.dataset.sfSkip="1";var t=n.getParentByClass(o,"stageWrapper");f.a.one(t,"mouseenter",this.wrapPhotoOnHover)}}},{css:"a",is:"added",callback:e=>{for(let t,n=0;t=e.added[n];n++)t.sfSkip>0||(t.sfSkip="1",this.wrapExternalMedia(t))}},{css:`.${f.a.onRemoveClassName}`,is:"removed",callback:e=>{for(let t,n=0;t=e.removed[n];n++)f.a.onRemoveListener(t)}}]})}},hideMenu:function(){g.contextMenu&&(g.contextMenu.hide(),g.contextMenu=null)}},k={linkDataAttr:"savefromEd",timer:0,lastLink:null,re:[/https?:\/\/(?:[a-z]+\.)?youtube\.com\/(?:#!?\/)?watch\?[^\s\"\'\<\>]*v=([\w\-]+)/i,/https?:\/\/(?:[a-z0-9]+\.)?youtube\.com\/(?:embed|v)\/([\w\-]+)/i,/https?:\/\/(?:[a-z]+\.)?youtu\.be\/([\w\-]+)/i,/https?:\/\/(?:[\w\-]+\.)?vimeo\.com\/(\d+)(?:\?|$)/i],thumbnail:{youtube:{re:[/ytimg\.com(?:\/|%2F)vi(?:\/|%2F)([\w\-]+)(?:\/|%2F)/i],url:"http://www.youtube.com/watch?v={vid}"}},disable:function(){var e=n.embedDownloader.panel;e&&(e.style.display="none")},removeBtn:function(e){if(e&&"object"==typeof e){var t=e.querySelector("."+g.className);t&&(t.parentNode.removeAttribute(Object(l.a)(k.linkDataAttr)),t.parentNode.removeChild(t)),e.removeAttribute(Object(l.a)(k.linkDataAttr)),e==this.lastLink&&(this.lastLink=null)}},checkUrl:function(e,t){if(!t&&e.search(/https?:\/\/([\w\-]+\.)?facebook\.com\/l\.php/i)>-1)return this.checkUrl(decodeURIComponent(e),!0);for(var n=0,o=this.re.length;n<o;n++){var r=e.match(this.re[n]);if(r&&r.length>0)return r[0]}},handle:function(e){var t=e.querySelector("img");if(t){var o=t.parentNode;if(t.src&&"relative"==n.getStyle(o,"position")){var r=e.getAttribute("ajaxify");if(r&&r.search(/\/flash\/expand_inline/i)>-1){var a=this.getThumbnailUrl(t.src);if(a)return this.createButton(a,o,e,{display:"block",position:"absolute",bottom:"3px",right:"3px",zIndex:9999,margin:0,width:"16px",height:"16px"},{display:"block"})}else if(this.checkUrl(e.href))return this.createButton(e.href,o,e,{display:"block",position:"absolute",bottom:"3px",right:"3px",zIndex:9999,margin:0,width:"16px",height:"16px"},{display:"block"})}return!1}return this.createButton(e.href,e,e)},getThumbnailUrl:function(e){for(var t in this.thumbnail)for(var o=0;o<this.thumbnail[t].re.length;o++){var r=n.getMatchFirst(e,this.thumbnail[t].re[o]);if(r)return this.thumbnail[t].url.replace(/\{vid\}/gi,r)}return""},createButton:function(e,t,r,a,i){if(!(e=this.checkUrl(e)))return!1;var s=document.createElement("a");s.className=g.className,s.href="http://savefrom.net/?url="+encodeURIComponent(e),s.setAttribute(n.embedDownloader.dataAttr,e),s.title=o.a.i18n.getMessage("download"),n.setStyle(s,{marginLeft:"7px",verticalAlign:"middle"}),a&&n.setStyle(s,a);var l=document.createElement("img");return l.className="icon",l.src=n.svg.getSrc("download","#a2db16"),n.setStyle(l,{display:"inline-block",width:"16px",height:"16px",verticalAlign:"middle",cursor:"pointer"}),i&&n.setStyle(l,i),s.appendChild(l),r.dataset[this.linkDataAttr]=1,t.appendChild(s),!0}};const w={createButton(e,t={}){const n={default:{props:{},style:{}},circle:{props:{isText:!1,isCircle:!0},style:{}},withoutText:{props:{isText:!1},style:{}},hover:{className:"sf-hover-container",props:{isText:!1},style:{position:"absolute",top:"8px",left:"8px"}}};let o=t&&t.preset?t.preset:"default",r=n[o]?n[o]:n.default,{props:a,style:i}=r;t&&t.style&&(i=Object.assign(i,t.style));const s=p.a.create("div",{class:r.className||"sf-download-container",style:i});return Object(y.a)(Object(L.f)(C,{...a,onClick:t=>{t.preventDefault(),t.stopPropagation(),e(t)}}),s),s}};var x={getLinksFromEmbed:function(e,t){if(!e)return t(null);var n=e.getAttribute("flashvars");if(null===n)return t(null);var o=Object(s.a)(n).params;if(!o)return t(null);var r=null;try{r=JSON.parse(o).video_data}catch(e){}if(!r)return t(null);r.progressive&&(r=r.progressive);var a={},i={sd_src:"SD",hd_src:"HD"};Array.isArray(r)||(r=[r]);for(var l,d=0;l=r[d];d++)["sd_src","hd_src"].forEach((function(e){l[e]&&(a[l[e]]=i[e])}));return t({links:a})},getVideoIdFromLink(e){let t=e.match(/videos\/(\d+)/);return t&&t[1]},requestLocalVideoLinks:function(e){return new Promise((function(e,t){n.bridge({func:'function(cb){var err=null;var token=null;try{token=window.require("DTSGInitialData").token}catch(_err){err=_err.message}cb([err,token])}',cb:function(n){var o=null,r=null;!n||n[0]?o=new Error("Get token timeout"):r=n[1],o?t(o):e(r)}})})).then((function(t){const n=`https://www.facebook.com/video/tahoe/async/${e}/?${_.stringify({payloadtype:"primary"})}`,o=_.stringify({__a:1,fb_dtsg:t});return Object(h.a)([n,o],'function(url,data){return fetch(url,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:data}).then(function(response){return response.text()})}')})).then((function(t){return new Promise((function(n,r){o.a.sendMessage({action:"getFacebookLinksFromData",extVideoId:e,data:t},(function(e){e&&e.links?n(e):r(new Error("Get links from data error"))}))}))})).catch((function(e){throw E.error("get local links error",e),e}))},requestBgVideoLinks:function(e){return new Promise((function(t,n){o.a.sendMessage({action:"getFacebookLinks",extVideoId:e},(function(e){e&&e.links?t(e):n(new Error("Get links error"))}))})).catch((function(e){throw E.error("get links error",e),e}))},requestVideoLinksById:function(e){return Promise.resolve().then((function(){return x.requestLocalVideoLinks(e)})).catch((function(){return x.requestBgVideoLinks(e)}))},requestVideoLinks:function(e,t){return x.requestVideoLinksById(e).then((function(e){t(e.links,e.title)}),(function(e){t()}))},getLinksFromVideo:function(e,t){if(!e)return t(null);const o={};var r,a={},s=null;if(!s){let t=Object(u.a)(e,"div[data-ft]");if(t&&Object(c.a)(t,".userContentWrapper[data-ft] "+t.tagName)&&(t=Object(u.a)(t,".userContentWrapper[data-ft]")),t&&(Array.from(t.querySelectorAll("a[href]")).some(e=>{const t=/\/videos\/(\d+)/.exec(e.href);if(t)return s=t[1],o.popup_1=!0,!0}),!s)){let e=null;try{e=JSON.parse(t.dataset.ft)}catch(e){}if(e){const t=e.mf_story_key,n=e.story_attachment_style;t&&"video_inline"===n&&(s=t,o.popup_1=!0)}}}if(!s){if(Object(u.a)(e,"div._5-yb")){const e=/\/videos\/(\d+)/.exec(location.href);if(e){return t({links:{id:e[1]},popup_1:!0})}}}if(!s){var l=Object(u.a)(e,".uiStreamStory[data-story-id]"),d=/:(\d+)$/.exec(l&&l.dataset.storyId);(d=d&&d[1])&&(s=d)}if(!s&&(r=Object(i.a)(e,"fbUserContent"))){var f=r.querySelector("a[data-video-id]");if(f)(v=f&&f.dataset.videoId)&&(s=v)}if(!s&&(r=Object(u.a)(e,".userContentWrapper"))){var p=r.querySelector('div[id^="feed_subtitle_"] a[data-video-channel-id]');if(p){var h=/\/videos\/(\d+)/.exec(p.href);(v=h&&h[1])&&(s=v)}else{var m=r.querySelectorAll('a.profileLink, a[rel="theater"], #fbPhotoSnowliftTimestamp > a[href]'),v=null;[].slice.call(m).some((function(e){var t=/\/videos\/(\d+)/.exec(e.href);return v=t&&t[1]})),v&&(s=v)}}if(!s){var g=!1,b=!1,y=document.getElementById("stream_pagelet"),k=y&&y.previousElementSibling;if(k&&k.contains(e)&&(g=!0),!g){var w=document.querySelector(".uiStreamStory"),S=w&&w.parentNode;(S=S&&S.parentNode)&&S.contains(e)&&(b=!0)}if(g||b)(v=x.getVideoIdFromUrl())&&(s=v)}if(!s&&Object(u.a)(e,"#pagelet_group_permalink")){h=/video_id:"?([^,"]+)/.exec(document.body.innerHTML);(v=h&&h[1])&&(s=v)}if(s&&(a.id=s),e.src&&/^https?:/.test(e.src)){var M=n.getFileExtension(e.src,"mp4");a[e.src]=M.toUpperCase()}var B=e.querySelectorAll("source");if(B&&B.length>0)for(var F=0;F<B.length;F++){M=n.getFileExtension(B[F].src,"mp4");a[B[F].src]=M.toUpperCase()}return Object.keys(a).length?(o.links=a,t(o)):t(null)},getVideoIdFromUrl:function(){var e=null;return n.embedDownloader.hostings.facebook.re.some((function(t){var n=t.exec(location.href);if(n)return e=n[1],!0})),e||(e=(e=document.location.href.match(/(\d+).$/))&&e[1]?e[1]:null),e},getFileName:function(e){var t=n.getFileName(e);if(t)return t;var o=n.dateToObj();return"facebook_"+(o.year+"-"+o.month+"-"+o.day+"_"+o.hour+"-"+o.min)+"."+n.getFileExtension(e,"mp4")},prepareLinks:function(e,t){var n=[];for(var r in e){var a=this.getFileName(r),i=a.lastIndexOf("."),s=a.substr(i+1),l={href:r,title:a=t||a.substr(0,i),format:s.toUpperCase(),quality:e[r],forceDownload:!0};n.push(l)}return 0===n.length&&(n=o.a.i18n.getMessage("noLinksFound")),n},appendLinks:function(e){if(e){var t=document.getElementById("fbPhotoPageMediaInfo");if(null!==t){var r=document.querySelector("h2.uiHeaderTitle");if(r&&(r=r.textContent),t&&!t.querySelector("."+g.className)){var a=document.createElement("div");a.className=g.className;var i=p.a.create("div",{title:o.a.i18n.getMessage("download"),style:{display:"inline-block",width:"16px",height:"16px",backgroundImage:"url("+n.svg.getSrc("download","#a2db16")+")",backgroundRepeat:"no-repeat",backgroundPosition:"center center",verticalAlign:"middle",cursor:"pointer"}});a.appendChild(i);var s=null;i.addEventListener("click",(function(){if(g.contextMenu&&g.contextMenu.isShow)g.hideMenu();else{var t=g.contextMenu=n.popupMenu.quickInsert(this,o.a.i18n.getMessage("download")+" ...",g.className+"_popup");if(s)t.update(s);else if(e.id){var a=e.id;delete e.id,x.requestVideoLinks(a,(function(o,r){s=o?n.popupMenu.prepareLinks.facebook(o,r):x.prepareLinks(e),t.update(s)}))}else s=x.prepareLinks(e,r),t.update(s)}})),t.appendChild(a),t=null,a=null,i=null}}}},rmBtn:function(){for(var e,t=document.querySelectorAll("."+g.className),n=0;e=t[n];n++)e.parentNode.removeChild(e)},showDownloadMenuByVideoId(e,t){if(g.contextMenu&&g.contextMenu.isShow)return void g.hideMenu();const r=g.contextMenu=n.popupMenu.quickInsert(e,o.a.i18n.getMessage("download")+" ...",g.className+"_popup");x.requestVideoLinks(t,(function(e,t){var o;o=e?n.popupMenu.prepareLinks.facebook(e,t):x.prepareLinks(links),r.update(o)}))}},S={style:null,getFilenameFromUrl:function(e){return n.getMatchFirst(e,/\/([^\/]+\.[a-z0-9]{3,4})(?:\?|$)/i)},getPhotoIdFromUrl:function(){var e=null,t=Object(s.a)(location.href);return t.fbid&&(e=t.fbid),e},prepPhotoUrl:function(e){e&&(/[?&]dl=1/.test(e)||(e+=(/\?/.test(e)?"&":"?")+"dl=1"));return e},rmCurrentPhotoBtn:function(e){for(var t,n=void 0,o=document.querySelectorAll(".sf-dl-current-photo-btn"),r=0;t=o[r];r++)e&&e.contains(t)?n=t:t.parentNode.removeChild(t);return n},injectStyle:function(){this.style?this.style.parentNode||document.head.appendChild(this.style):(this.style=p.a.create("style",{text:Object(d.a)({"div > .sf-dl-current-photo-btn":{display:"none",position:"absolute",top:"10px",left:"10px",width:"28px",height:"24px",border:0,zIndex:100,cursor:"pointer",backgroundColor:"#000",padding:0,borderRadius:"2px",opacity:.4,transition:"opacity 100ms linear",lineHeight:0},"div > .sf-dl-current-photo-btn svg":{margin:"4px"},"div > .sf-dl-current-photo-btn:hover":{opacity:.8},"div > .sf-dl-current-photo-btn:hover svg path":{fill:"#00B75A"},"body:not(.fullScreen) div:hover > .sf-dl-current-photo-btn":{display:"block"}})}),document.head.appendChild(this.style))},getPhotoUrlFromCtr:function(e){var t=[],n=e.querySelector("img.spotlight")||e.querySelector("img.fbPhotoImage");return n&&t.push(n.src),t},getVideoUrlFromPhotoCtr:function(e){var t=null,n=e.querySelector(".stage .videoStage video");if(n){var o=Object(u.a)(n,".fbPhotoSnowliftPopup");if(o){var r=o.querySelector('div[id^="feed_subtitle_"] a[data-video-channel-id]');if(r){var a=/\/videos\/(\d+)/.exec(r.href);a&&(t=a[1])}}}return t},getLinksFromPhotoCtr:function(e){return Object(c.a)(e,".stageWrapper.showVideo")?Promise.resolve().then((function(){var t=x.getVideoIdFromUrl();if(t||(t=S.getVideoUrlFromPhotoCtr(e)),t)return x.requestVideoLinksById(t)})).then((function(e){return n.popupMenu.prepareLinks.facebook(e.links,e.title)})):Promise.resolve().then((function(){var e=S.getPhotoIdFromUrl();if(e)return new Promise((function(t,n){o.a.sendMessage({action:"getFacebookPhotoUrl",fbid:e},(function(e){e&&e.length?t(e):n(new Error("getFacebookPhotoUrl can't get url"))}))}));throw new Error("Can't get photo id from url")})).catch((function(t){return S.getPhotoUrlFromCtr(e)})).then((function(e){if(!e||!e.length)throw new Error("Photo url not found");return e.map((function(e){var t=S.prepPhotoUrl(e),n=m.a.modify(S.getFilenameFromUrl(t)),r=/(.+)\.([^.]+)$/.exec(n),a="jpg",i=n;return r&&(a=r[1],i=r[2]),{href:t,title:i,quality:o.a.i18n.getMessage("download"),format:" ",ext:a,isBlank:!0}}))}))},addDlCurrentPhotoBtn:function(e){if(!this.rmCurrentPhotoBtn(e)){var t=p.a.create("a",{class:"sf-dl-current-photo-btn",href:"#",title:o.a.i18n.getMessage("download"),append:[n.svg.getSvg("download","#FFF",16)],on:["click",function(t){if(t.stopPropagation(),t.preventDefault(),g.contextMenu&&g.contextMenu.isShow)g.hideMenu();else{var r=function(e){18!==e.keyCode&&17!==e.keyCode&&(a.hide(),document.removeEventListener("keydown",r))},a=g.contextMenu=n.popupMenu.quickInsert(this,o.a.i18n.getMessage("download")+" ...","photoDlMenu",{parent:e,onShow:function(){g.isMutation||document.addEventListener("keydown",r)},onHide:function(){g.isMutation||document.removeEventListener("keydown",r)}});S.getLinksFromPhotoCtr(e).then((function(e){e.forEach((function(e){e.func=function(t){t.preventDefault(),n.download(null,e.href),a.hide()}})),a.update(e)})).catch((function(e){E.debug("Get photo links error",e),a.update(o.a.i18n.getMessage("noLinksFound"))}))}}]});e.appendChild(t)}},addButtonForArticleImage(e){const t=e.closest("a");if(!t)return;const o=w.createButton(()=>{let t=S.getFilenameFromUrl(e.src);t||(t=document.title+".jpg"),n.download(m.a.modify(t),e.src)},{preset:"hover"});t.appendChild(o)},addButtonForShowPageImage(e){let t={position:"absolute",zIndex:9999};t=document.querySelector('[role="banner"] [hidden]')?Object.assign(t,{top:"9px",left:"115px"}):Object.assign(t,{top:"7px",left:"15px"});const o=e.closest('div:not([data-pagelet="MediaViewerPhoto"])');if(!o)return;const r=e.querySelector("img");if(!r)return;const a=w.createButton(()=>{let e=S.getFilenameFromUrl(r.src);e||(e=document.title+".jpg"),r&&n.download(m.a.modify(e),r.src)},{style:t,preset:"circle"});o.appendChild(a)},addCurrentDlBtn:function(e){e.dataset.sfSkip>0||(e.dataset.sfSkip="1",this.addDlCurrentPhotoBtn(e))},rmDataAttrs:function(){for(var e,t=Object(l.a)("sfSkip"),n=document.querySelectorAll("*["+t+"]"),o=0;e=n[o];o++)e.removeAttribute(t)}},M={style:null,addStyle:function(){if(this.style)return void(this.style.parentNode||document.head.appendChild(this.style));this.style=p.a.create("style",{class:"sfFeedStyle",text:Object(d.a)([{selector:"."+g.className+"-feed.sf-feed",style:{display:"none",width:"20px",height:"20px",padding:0,position:"absolute",background:"url("+n.svg.getSrc("download","#a2db16")+") center no-repeat transparent",backgroundSize:"16px",top:"5px",left:"5px",zIndex:1,cursor:"pointer"}},{selector:'div[role="dialog"] .'+g.className+"-feed.sf-feed",style:{top:"40px"}},{selector:"body:not(.fullScreen) div:hover > ."+g.className+"-feed.sf-feed",style:{display:"block"}},{selector:"."+g.className+"-feed.sf-feed:active",style:{outline:0}},{selector:".sf-hover-container",style:{display:"none"}},{selector:'div[role="presentation"]:hover .sf-hover-container, a[role="link"]:hover .sf-hover-container',style:{display:"block"}}])}),document.head.appendChild(this.style)},onDlBtnClick:function(e){if(e.preventDefault(),e.stopPropagation(),g.contextMenu&&g.contextMenu.isShow)g.hideMenu();else{try{var t=JSON.parse(this.dataset.sfDlLinks)}catch(e){return}var r=g.contextMenu=n.popupMenu.quickInsert(this,o.a.i18n.getMessage("download")+" ...",g.className+"_popup");if(t.id){var a=t.id;delete t.id,x.requestVideoLinks(a,(function(e,o){var a;a=e?n.popupMenu.prepareLinks.facebook(e,o):x.prepareLinks(t),r.update(a)}))}else{var i=x.prepareLinks(t);r.update(i)}}},addDownloadBtn:function(e,t){var n=e.querySelector("."+g.className+"-feed");n&&n.parentNode.removeChild(n),e.appendChild(p.a.create("a",{data:{sfDlLinks:JSON.stringify(t)},title:o.a.i18n.getMessage("download"),class:[g.className+"-feed","sf-feed"],href:"#",on:["click",M.onDlBtnClick]}))},addButtonForWatchPage(e){const t=e.closest("._6x84"),n=t.querySelector('a[href*="/videos/"]');if(!n||!n.href)return;let o=x.getVideoIdFromLink(n.href);if(!o)return;const r=t.querySelector("._8y72._18vi"),a=r.closest("div"),i=w.createButton(()=>{x.showDownloadMenuByVideoId(i,o)});a.insertBefore(i,r)},addButtonForFeedPage(e){const t=e.closest('[role="article"]'),n=t.querySelector('a[href*="/videos/"]');if(!n)return;let o=x.getVideoIdFromLink(n.href);if(!o)return;let r='[role="article"] div > div > div > div:nth-child(2) > div > div:nth-child(4) > div > div > div > div > div:nth-child(2) > div > div';/profile\.php/.test(location.href)&&(r='[role="article"] > div > div > div > div > div > div:nth-child(2) > div > div:last-child > div > div > div > div > div > div > div');const a=t.querySelector(r);if(!a)return;const i=w.createButton(()=>{x.showDownloadMenuByVideoId(i,o)},{preset:"withoutText",style:{alignItems:"center",display:"flex"}});a.parentElement.insertBefore(i,a)},addButtonForShowPageVideo(e){const t=w.createButton(e=>{let t=x.getVideoIdFromLink(location.href);t&&x.showDownloadMenuByVideoId(e.target,t)},{preset:"circle",style:{position:"absolute",top:"8px",left:"114px"}});e.appendChild(t)},addHoverButtonForArticleVideo(e){let t=x.getVideoIdFromLink(e.href);if(!t)return;const n=e.closest('[role="article"], ._6x84');if(!n)return;const o=n.querySelector('div[role="presentation"]');if(!o)return;const r=w.createButton(e=>{x.showDownloadMenuByVideoId(e.target,t)},{preset:"hover"});o.appendChild(r)},onLinkHover:function(){var e=this;if(!(this.dataset.hasSfFeedBtn>1)){this.dataset.hasSfFeedBtn="1";var t=this;return"VIDEO"===t.tagName&&(t=t.querySelector("embed")||this),new Promise(e=>{"EMBED"===t.tagName?x.getLinksFromEmbed(t,e):"VIDEO"===t.tagName&&x.getLinksFromVideo(t,e)}).catch(e=>(E("getLinks error",e),null)).then(t=>{const n=t&&t.links;if(n)if(t&&t.popup_1)M.addDownloadBtn(e.parentNode,n);else if(Object(c.a)(e,".uiStreamStory "+e.tagName)||Object(c.a)(e,".fbPhotoSnowliftContainer "+e.tagName)){Object(u.a)(e,".fbPhotoSnowliftPopup .stageWrapper")||M.addDownloadBtn(e.parentNode,n)}else{var o=document.getElementById("pagelet_timeline_main_column")||document.getElementById("stream_pagelet")||document.getElementById("mainContainer");if(o&&o.contains(e))M.addDownloadBtn(e.parentNode,n);else{var r=document.getElementById("stream_pagelet"),a=r&&r.previousElementSibling;if(a&&a.contains(e))M.addDownloadBtn(e.parentNode,n);else{var i=document.querySelector(".uiStreamStory"),s=i&&i.parentNode;(s=s&&s.parentNode)&&s.contains(e)&&M.addDownloadBtn(e.parentNode,n)}}}else e.dataset.hasSfFeedBtn=0})}},rmBtn:function(){let e=[Object(l.a)("hasSfFeedBtn"),Object(l.a)("sfReady")];const t=e.map(e=>`[${e}]`).join(",");document.querySelectorAll(t).forEach(t=>{e.forEach(e=>t.removeAttribute(e))});const n=[".sf-hover-container",".sf-download-container","."+g.className+"-feed"].join(",");document.querySelectorAll(n).forEach(e=>{e.parentNode.removeChild(e)})}}}))}});